name: next-gen-server

volumes:
  shared-volume:
    external: true

services:
  next-gen-server:
    image: next-gen-server:latest
    container_name: next-gen-server
    hostname: next-gen-server
    build:
      context: .
      dockerfile: ./dockerfile
    environment:
      NODE_ENV: production
    env_file:
      - .env  
    ports:
      - 9000:9000
      - 9229:9229
    develop:
      watch:
        - path: /src
          target: /app/src
          action: sync
        - path: package.json
          action: rebuild  
          ignore:
            - "node_modules/"
            - "Jenkinsfile"
            - "Jenkins.Dockerfile"
            - "*.md"
            - "*.dockerfile"  
    networks:
      - kafka-network
    volumes:
      - shared-volume:/app/dist/certificates:rw